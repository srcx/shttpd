<!--  manual.aft (c)2000 Stepan Roh -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>Manual for webserver shttpd</title>
	<meta name="author" content="Stepan Roh">
	<meta name="GENERATOR" content = "Almost Free Text v5.096; Copyright 1996-2005 Todd Coram. All rights reserved.">
<style type="text/css">
  <!--
	.Default {background-color: rgb(255,255,255); color: rgb(0,0,0); font-family: 'Tahoma'; font-size: 12pt}
	.Text-Background {background-color: rgb(255,255,255)}
  -->
</style>
</head>
<body>

<br><center><h1><a name="AFT-top">Manual for webserver shttpd</a></h1></center>
<br><center><h2>Stepan Roh</h2></center>
<center>Version 0.3.1</center>
<center>Document revision 1.2 (2009/05/17)</center>
<p class="Body">
<strong>Motto: 's' as stupid.</strong>
</p>
<!-- Start SectLevel1 -->
<h2><a name="Features">Features</a></h2>
<p class="Body">
shttpd is intended mainly for personal use. Even ordinary user can run it even though
he must use port numbers greater than 1024. It supports reasonable subset of
HTTP/1.0 and HTTP/1.1 (no virtual servers, conditional GET or persistent
connections). Can handle only static pages, no dynamics (SSI, PHP and so
on). From this results that it can handle only methods GET, HEAD, OPTIONS
and TRACE. It does not support modules.
</p>
<p class="Body">
For its run it needs a configuration file. By default it is shttpd.cfg in
current directory, but name can be changed by parameter -f (see shttpd -?).
</p>
<p class="Body">
Server run ends by Ctrl-C (if it is run on foreground) or by sending one of
signals SIGINT, SIGHUP, SIGTERM.
</p>
<!--End Section 1-->
<h2><a name="Internals">Internals</a></h2>
<p class="Body">
Without threads support (can be found out with shttpd -?) it can handle only
one request at a time. If threads are compiled-in then threads are created
as long as all requests are handled or number of running threads reaches
given limit.
</p>
<!--End Section 1-->
<h2><a name="Syntax of the configuration file">Syntax of the configuration file</a></h2>
<p class="Body">
Comments are preceded by character '#'. Configuration file consists of lines
in the format &lt;variable_name&gt; &lt;value&gt;. String values are written in
quotation marks - may contain sequences starting with '\' ('&quot;' for quotation
mark, '\' for backslash, 'n' for newline, 't' for tabulator, 'r' for
carriage return alias CR).
</p>
<p class="Body">
Usable variables:
</p>
<dl>
<dt><strong><tt>min_threads</tt></strong></dt><dd> number of threads which exists during whole server run (valid only if threads support is compiled-in); default: 4</dd>
<dt><strong><tt>max_threads</tt></strong></dt><dd> max number of threads (if threads support is not compiled-in than it defines max number of waiting requests); default: 16</dd>
<dt><strong><tt>port</tt></strong></dt><dd> TCP/IP port where server listens to requests (standard HTTP port is 80); default: 8080</dd>
<dt><strong><tt>access_log</tt></strong></dt><dd> name of the file where connections information is stored - it has lines in the format: &quot;<tt>[date and time] address from &quot;first line of request&quot; status code length of transferred data</tt>&quot; If it is set to '-' there will be no access logging; default: &quot;access_log.shttpd&quot;</dd>
<dt><strong><tt>error_log</tt></strong></dt><dd> name of the file where server messages are stored - both normal and error. If it is set to '-' there will be no logging; default: &quot;error_log.shttpd&quot;</dd>
<dt><strong><tt>log_level</tt></strong></dt><dd> lowest log level for messages written to error log. Possible values are (from lowest to highest): LOG_LEVEL_INFO, LOG_LEVEL_WARN, LOG_LEVEL_ERR, LOG_LEVEL_SYS, LOG_LEVEL_MAX (nothing will be written); default: LOG_LEVEL_INFO</dd>
<dt><strong><tt>error_log_stderr</tt></strong></dt><dd> 1 if everything written to error log should be written to stderr (standard error output) too - 0 otherwise; default: 1</dd>
<dt><strong><tt>doc_root</tt></strong></dt><dd> directory with to be shown documents. Must end with character '/'; default: &quot;html/&quot;</dd>
<dt><strong><tt>remote_names</tt></strong></dt><dd> 1 if name address is stored into access log - 0 for numeric address (translation from numeric to named can take some time); default: 1</dd>
<dt><strong><tt>status_page</tt></strong></dt><dd> has more complicated format &lt;status code&gt; &lt;string&gt; which assigns HTML response to some status code (e.g. 404 which is Not Found). If string is set to '-' without quotes only HTTP header Status and empty body are sent. First sequence '%s' in the string is replaced by name of the document which triggered the error; default: all errors generated by the server are defined (those are 301, 400, 403, 404, 405, 505).</dd>
<dt><strong><tt>index_file</tt></strong></dt><dd> what file should be taken if directory is requested; default: &quot;index.html&quot;</dd>
<dt><strong><tt>media_type</tt></strong></dt><dd> media (MIME) type which should be returned in the response if type of sent data can not be determined; default: &quot;text/plain&quot;</dd>
<dt><strong><tt>media_config</tt></strong></dt><dd> name of the file with media (MIME) type definitions. If set to '-' no file is read. File has lines in the format: &quot;<tt>media (MIME) type&nbsp;&nbsp;[extension1 extension2 ...]</tt>&quot; and comment lines beginning with '#'. Extensions are without leading dot. Types of sent files are determined by looking up their extensions in this file; default: &quot;mime.types&quot;</dd>
</dl>
<!--End Section 1-->
<h2><a name="Changes between versions">Changes between versions</a></h2>
<p class="Body">
Changes from version 0.3 to version 0.3.1 (2009/17/05)
<ul>
<li> SECURITY FIX: prevent arbitrary directory traversal</li>
</ul>
</p>
<p class="Body">
Changes from version 0.2 to version 0.3 (2000/10/03)
<ul>
<li> data are sent in blocks</li>
<li> length of transferred data is stored in access_logu</li>
<li> SIGPIPE is ignored which previously terminated server if connection was terminated by client, but data were still transferred</li>
<li> sequence CR LF is sent as end of line (according to RFC 2068)</li>
<li> documentation in the aft format</li>
</ul>
</p>
<p class="Body">
Changes from version 0.1 (2000/01/05) to version 0.2 (2000/02/25)
<ul>
<li> configure added</li>
<li> finished 301 Moved Permanently code generation</li>
<li> bug fixes</li>
</ul>
</p>
<!--End Section 1-->
<h2><a name="Known bugs">Known bugs</a></h2>
<ul>
<li> IRIX 6.5: IP address written to log is wrong - maybe wrong system implementation of the function inet_ntoa()</li>
<li> IRIX 6.5: &quot;Segmentation fault&quot; on exit of the server compiled with threads and without debugging information</li>
</ul>
<!--End Section 1-->
<h2><a name="Possible future enhancements">Possible future enhancements</a></h2>
<ul>
<li> Handling of conditional GET (generation of code 304).</li>
<li> Generation of Expires header.</li>
<li> Generation of Last-Modified header.</li>
<li> Generation of server status page.</li>
<li> Better usage of temporary threads.</li>
<li> Dynamic size of input buffers.</li>
<li> Persistent connections.</li>
<li> Virtual servers.</li>
<li> Dynamic pages and modules.</li>
</ul>
<center>Stepan Roh &lt;src@post.cz&gt;</center>
<!--End Section 1-->
<!-- End SectLevel1 -->
<hr>
<br>
<p align="right"> <small>This document was generated using <a class="link" href="http://www.maplefish.com/todd/aft.html">AFT v5.096</a></small> </p>
</body>
</html>

